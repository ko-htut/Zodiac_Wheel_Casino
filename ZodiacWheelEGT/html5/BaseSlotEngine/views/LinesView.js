CanvasView("LinesView",{BLINKING_COMPLETE:"blinkingComplete"},function(){function r(){this._context.clearRect(this._lastBoundingRectangle.left-5,this._lastBoundingRectangle.top-5,10+this._lastBoundingRectangle.right-this._lastBoundingRectangle.left,10+this._lastBoundingRectangle.bottom-this._lastBoundingRectangle.top);this._linesDrawn=0}function s(){this._blinkPhase=0==this._blinkPhase?1:0;0==this._blinkPhase&&++this._currentBlinkCount==this._targetBlinkCount?(clearInterval(this._blinkTimer),this._blinkTimer=
0,this._colorMultiplier=1,this._lastDrawnLine=-1,r.call(this),this.dispatchEvent(new Event(LinesView.BLINKING_COMPLETE))):(this._colorMultiplier=0==this._blinkPhase?1:0.7,-1!=this._lastDrawnLine?this.drawLine(this._lastDrawnPositions,this._lastDrawnLine):this.drawCells(this._lastDrawnPositions,this._lastDrawnColor))}function n(d){d=d.toString(16);1==d.length&&(d="0"+d);return d}return{init:function(d){this._config=d;this._blinkTimer;this._targetBlinkCount;this._currentBlinkCount;this._blinkPhase;
this._linesDrawn;this._colorMultiplier;this._lastDrawnPositions;this._lastDrawnLine;this._lastDrawnColor;this._lastBoundingRectangle;this._super("",151,66);this.setSize(979,540);this.setZIndex(4);this._colorMultiplier=1;this._lastDrawnLine=-1;this._lastBoundingRectangle={}},drawLines:function(d){var e,g;this._linesDrawn=d;this._context.lineWidth=8;this._context.lineJoin="round";this._context.lineCap="round";for(var c=0;c<d;c++){this._context.beginPath();e=this._config.lines[c].gfx;g=this._config.lines[c].color;
_ctx.strokeStyle=g;this._context.moveTo(e[0],e[1]+4);g=e.length;for(var b=2;b<g;b+=2)this._context.lineTo(e[b],e[b+1]+4);this._context.stroke()}},drawLine:function(d,e){this._lastDrawnPositions=d.slice();this._lastDrawnLine=e;d=d.slice();for(var g=d.length/2+1,c=1;c<g;c++)d.splice(c,1);var b=this._config.lines[e].gfx,f=this._config.lines[e].color,m=this._config.lines[e].cells,q=this._config.lines[e].functionType,c=f>>16&255,l=f>>8&255,f=f&255;1!=this._colorMultiplier&&(c=Math.floor(c*this._colorMultiplier),
l=Math.floor(l*this._colorMultiplier),f=Math.floor(f*this._colorMultiplier));this._context.strokeStyle="#"+n.call(this,c)+n.call(this,l)+n.call(this,f);this._context.lineWidth=8;this._context.lineJoin="round";this._context.lineCap="round";this._context.beginPath();this._lastBoundingRectangle.left=b[0];this._lastBoundingRectangle.right=b[b.length-2];this._lastBoundingRectangle.top=this._context.canvas.height;for(var l=this._lastBoundingRectangle.bottom=0,f=Math.floor(this._config.reelHeight/this._config.numReelImages),
h,a,c=0;c<this._config.numReels;c++){h=[];0==q[l+1]&&0==q[l+2]?h.push(l++,l++,l++):h.push(l++,l++);var p=h[0];0!=p&&(a=b[2*(p-1)+1],this._context.moveTo(b[2*(p-1)],a),this._lastBoundingRectangle.top>a&&(this._lastBoundingRectangle.top=a),this._lastBoundingRectangle.bottom<a&&(this._lastBoundingRectangle.bottom=a));p=d.indexOf(c);if(-1==p)for(var g=h.length,k=0;k<g;k++)a=b[2*h[k]+1],0==h[k]?this._context.moveTo(b[2*h[k]],a):this._context.lineTo(b[2*h[k]],a),this._lastBoundingRectangle.top>a&&(this._lastBoundingRectangle.top=
a),this._lastBoundingRectangle.bottom<a&&(this._lastBoundingRectangle.bottom=a);else for(k=0;k<g;k++)a=b[2*h[k]+1],0==q[h[k]]?this._context.moveTo(b[2*h[k]],a):this._context.lineTo(b[2*h[k]],a),this._lastBoundingRectangle.top>a&&(this._lastBoundingRectangle.top=a),this._lastBoundingRectangle.bottom<a&&(this._lastBoundingRectangle.bottom=a);-1!=p&&(a=m[2*c+1],h=this._config.reelCoordX+m[2*c]*(this._config.reelWidth+this._config.reelSpacing),a=this._config.reelCoordY+a*f,0==c?this._lastBoundingRectangle.left=
h:c==this._config.numReels-1&&(this._lastBoundingRectangle.right=h+this._config.reelWidth),this._lastBoundingRectangle.top>a&&(this._lastBoundingRectangle.top=a),this._lastBoundingRectangle.bottom<a+f&&(this._lastBoundingRectangle.bottom=a+f),this._context.strokeRect(h,a,this._config.reelWidth,f))}this._context.stroke()},drawCells:function(d,e){void 0==e&&(e=1697302);this._lastDrawnPositions=d.slice();this._lastDrawnColor=e;var g=e>>16&255,c=e>>8&255,b=e&255;1!=this._colorMultiplier&&(g=Math.floor(g*
this._colorMultiplier),c=Math.floor(c*this._colorMultiplier),b=Math.floor(b*this._colorMultiplier));this._context.strokeStyle="#"+n.call(this,g)+n.call(this,c)+n.call(this,b);this._context.lineWidth=8;this._context.lineJoin="round";this._lastBoundingRectangle.left=this._context.canvas.width;this._lastBoundingRectangle.right=0;this._lastBoundingRectangle.top=this._context.canvas.height;this._lastBoundingRectangle.bottom=0;for(var g=Math.floor(this._config.reelHeight/this._config.numReelImages),c=d.length,
f,m=0;m<c;m+=2)f=d[m+1],b=this._config.reelCoordX+d[m]*(this._config.reelWidth+this._config.reelSpacing),f=this._config.reelCoordY+f*g,this._lastBoundingRectangle.left>b&&(this._lastBoundingRectangle.left=b),this._lastBoundingRectangle.right<b+this._config.reelWidth&&(this._lastBoundingRectangle.right=b+this._config.reelWidth),this._lastBoundingRectangle.top>f&&(this._lastBoundingRectangle.top=f),this._lastBoundingRectangle.bottom<f+g&&(this._lastBoundingRectangle.bottom=f+g),this._context.strokeRect(b,
f,this._config.reelWidth,g)},startBlinking:function(d,e){if(!this._blinkTimer){this._targetBlinkCount=d;this._blinkPhase=this._currentBlinkCount=0;var g=this;this._blinkTimer=setInterval(function(){s.call(g)},e)}},dispose:function(){this._blinkTimer&&(clearInterval(this._blinkTimer),this._blinkTimer=0);r.call(this);this._super()}}}());
