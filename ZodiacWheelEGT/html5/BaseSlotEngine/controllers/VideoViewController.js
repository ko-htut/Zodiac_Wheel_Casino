ViewController("VideoViewController",{EXPAND_COMPLETE:"expandComplete",CLEAR_CELLS:"clearCells"},function(){function m(a,b,e,f){for(var d=GameSettings.getInstance(),c=d.serverMessage,l=e?d.reelVideos.length:SpinAnalyzer.getCardAfterExpand(a,b,c),h,g=d.scatterConfig.length,k=0;k<g;k++)if(l==d.scatterConfig[k].index){h=d.scatterConfig[k];break}if(c.freeSpinScatters&&h&&-1!=h.freespinsVideoIndex)for(g=c.freeSpinScatters.length,k=0;k<g;k++)if(c.freeSpinScatters[k]==l){l=d.freespinGame&&void 0!=h.freespinsVideoIndexInFS?
h.freespinsVideoIndexInFS:h.freespinsVideoIndex;break}if(c=e?d.expandVideo:d.reelVideos[l])c.onWholeReel&&(b=0),(h=Loader.getLoader(c.src).getData())?(this._videos[l]||(c.loop=!e,f=new VideoPlayer(h,this._view.getContext2D(),c,f),f.addEventListener(VideoPlayer.VIDEO_READY,n,this),e&&f.addEventListener(VideoPlayer.VIDEO_COMPLETE,p,this),this._videos[l]=f),this._videos[l].addInstance({x:d.reelCoordX+a*(d.reelWidth+d.reelSpacing),y:d.reelCoordY+d.reelHeight/d.numReelCards*b,row:b,col:a})):e||this._requestedVideos.push({col:a,
row:b})}function g(){var a=GameSettings.getInstance();this._videos[a.reelVideos.length]&&(this._videos[a.reelVideos.length].removeEventListener(VideoPlayer.VIDEO_READY,n,this),this._videos[a.reelVideos.length].removeEventListener(VideoPlayer.VIDEO_COMPLETE,p,this),this._videos[a.reelVideos.length].dispose(),this._videos[a.reelVideos.length]=null);for(var a=this._videos.length,b=0;b<a;b++)this._videos[b]&&!this._videos[b].isPlaying()&&this._videos[b].play();this._winVideosStarted=!0}function n(a){this.dispatchEvent(new Event(VideoViewController.CLEAR_CELLS,
{cells:a.target.getVideoCells()}))}function p(){console.log("EXPAND COMPLETE");this.dispatchEvent(new Event(VideoViewController.EXPAND_COMPLETE));g.call(this)}function q(a){a=this._requestedVideos.length;for(var b=0;b<a;b++)m.call(this,this._requestedVideos[b].col,this._requestedVideos[b].row,!1,!0);this._winVideosStarted&&g.call(this)}return{init:function(){this._videos=[];this._requestedVideos=[];this._winVideosStarted=!1;this._super();this._view=new CanvasView("",151,66);this._view.setSize(979,
540);this._view.setZIndex(3);var a=GameSettings.getInstance(),b=a.serverMessage,e=b.expand.length;if(!a.processingSubscribe)for(a=0;a<e;a+=2)m.call(this,b.expand[a],b.expand[a+1],!0);e=b.lines.length;for(a=0;a<e;a++)for(var f=b.lines[a].cells,d=f.length,c=0;c<d;c+=2)m.call(this,f[c],f[c+1],!1);e=b.scatters.length;for(a=0;a<e;a++)for(d=b.scatters[a].cells.length,c=0;c<d;c+=2)m.call(this,b.scatters[a].cells[c],b.scatters[a].cells[c+1],!1);Loader.getQueue("slotVideos").addEventListener(LoaderEvent.COMPLETE,
q,this)},start:function(){var a=GameSettings.getInstance(),b=a.serverMessage,e=SoundManager.getInstance();if(b.expand.length){if(this._videos[a.reelVideos.length])this._videos[a.reelVideos.length].play();else if(a.processingSubscribe)this.dispatchEvent(new Event(VideoViewController.EXPAND_COMPLETE)),g.call(this);else{var f=this,b=1E3*e.getSoundLength("expandSound");0>=b&&(b=1200);setTimeout(function(){f.dispatchEvent(new Event(VideoViewController.EXPAND_COMPLETE));g.call(f)},b)}a.processingSubscribe||
e.play("expandSound")}else this.dispatchEvent(new Event(VideoViewController.EXPAND_COMPLETE)),g.call(this)},dispose:function(){Loader.getQueue("slotVideos").removeEventListener(LoaderEvent.COMPLETE,q,this);for(var a=this._videos.length,b=0;b<a;b++)this._videos[b]&&this._videos[b].dispose();this._super()}}}());
