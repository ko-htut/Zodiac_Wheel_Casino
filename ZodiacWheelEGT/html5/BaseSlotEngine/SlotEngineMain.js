View("SlotEngineMain",{SPIN:"bet",COLLECT:"collect",GAMBLE:"gamble",JACKPOT:"jackpot",SET_RESULT:"setResult",HIDE_GAME:"hideGame",MSG_SUCCESS:"success",MSG_INSUFFICIENT_FUNDS:"insufficientFunds",MSG_REALITY_CHECK:"doRealityCheck",MSG_BET_LIMIT:"betLimitReached",MSG_LOSS_LIMIT:"lossLimitReached",MSG_TIME_LIMIT:"sessionTimeLimitReached",MSG_TIME_PROXIMITY_ALERT:"timeProximityAlert",MSG_CREDIT_LEFT_ALERT:"creditLeftAlert"},function(){function f(a){a.target.removeEventListener(LoaderEvent.COMPLETE,f,
this);a.target.removeEventListener(LoaderEvent.ERROR,g,this);a=GameSettings.getInstance();a=new window[a.gameType+"Config"](a);a.prepareSettings();console.log("SETTINGS LOADED");var b=a.resources;a=GameSettings.getInstance();this._resourcesQueue=Loader.createQueue("slotResources");this._resourcesQueue.setAsyncScriptExecution(!1);for(var d=b.css?b.css.length:0,c=0;c<d;c++)this._resourcesQueue.addCssLoader(new CSSLoader(b.css[c]));d=b.js?b.js.length:0;for(c=0;c<d;c++)this._resourcesQueue.addScriptLoader(new ScriptLoader(b.js[c]));
d=b.img?b.img.length:0;for(c=0;c<d;c++)this._resourcesQueue.addImageLoader(new ImageLoader(b.img[c]));if(b.freespinAnimation){b=b.freespinAnimation;d=b.js.length;for(c=0;c<d;c++)this._resourcesQueue.addScriptLoader(new ScriptLoader(b.js[c]));d=b.css?b.css.length:0;for(c=0;c<d;c++)this._resourcesQueue.addCssLoader(new CSSLoader(b.css[c]));if(b.img){var e=null;b.img[a.currLanguage]?e=b.img[a.currLanguage]:b.img.en&&(e=b.img.en);d=e?e.length:0;for(c=0;c<d;c++)this._resourcesQueue.addImageLoader(new ImageLoader(e[c]));
d=b.img.nonlocalized?b.img.nonlocalized.length:0;for(c=0;c<d;c++)this._resourcesQueue.addImageLoader(new ImageLoader(b.img.nonlocalized[c]))}}SoundManager.getInstance().isSupported()&&this._resourcesQueue.addSoundLoader(new SoundLoader("common/commonSounds/dummy.mp3"));this._resourcesQueue.addEventListener(LoaderEvent.COMPLETE,h,this);this._resourcesQueue.addEventListener(LoaderEvent.PROGRESS,l,this);this._resourcesQueue.addEventListener(LoaderEvent.ERROR,k,this);this._resourcesQueue.load()}function g(a){a.target.removeEventListener(LoaderEvent.COMPLETE,
f,this);a.target.removeEventListener(LoaderEvent.ERROR,g,this);this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR));console.log("SETTINGS ERROR")}function h(a){a.target.removeEventListener(LoaderEvent.COMPLETE,h,this);a.target.removeEventListener(LoaderEvent.ERROR,k,this);a=GameSettings.getInstance();console.log("GAME READY TO START");var b=GameSettings.getInstance();if(this._currentState.state!=BaseMessage.STATE_IDLE){for(var d=b.denominations.length,c=0;c<d;c++)if(b.denominations[c][0]==this._currentState.denomination){b.currDenominationIndex=
c;break}for(var d=b.betValues.length,e=b.denominations[b.currDenominationIndex][0],c=0;c<d;c++)if(b.betValues[c]*e==this._currentState.bet){b.currBetIndex=c;break}d=b.linesCountConfig.length;for(c=0;c<d;c++)if(b.linesCountConfig[c]==this._currentState.numberOfLines){b.currLineIndex=c;break}}c=Loader.createQueue("slotVideos");b=a.reelVideos.length;for(d=0;d<b;d++)a.reelVideos[d]&&c.addImageLoader(new ImageLoader(a.reelVideos[d].src));a.expandVideo&&c.addImageLoader(new ImageLoader(a.expandVideo.src));
if(a.stopVideos)for(b=a.stopVideos.length,d=0;d<b;d++)a.stopVideos[d]&&c.addImageLoader(new ImageLoader(a.stopVideos[d].src));c.load();c=null;a.sendTotalsInfo&&(a.scaleCoef=694/720,a.paddingX=(1280-1280*a.scaleCoef)/2,a.paddingY=(720-720*a.scaleCoef)/2,c=new TotalsInfoView({currencyType:a.currencyType,totalBetLabel:a.localize("totalBetLabel"),totalWinLabel:a.localize("totalWinLabel"),noCoins:a.noCoins}),c.setSize(1280,26),c.setPosition(0,720),c.setScale(1/a.scaleCoef,1/a.scaleCoef));this._slotEngineController=
new SlotEngineController(this._currentState,c);b=this.events.length;for(d=0;d<b;d++)this._slotEngineController.addEventListener(this.events[d],m,this);this.addChild(this._slotEngineController._view);c&&this._slotEngineController._view.addChild(c);a.sendTotalsInfo&&(this._slotEngineController._view.setScale(a.scaleCoef,a.scaleCoef),this._slotEngineController._view.y((720*a.scaleCoef-720)/2));this.dispatchEvent(new LoaderEvent(LoaderEvent.COMPLETE))}function l(a){this.dispatchEvent(new LoaderEvent(LoaderEvent.PROGRESS,
a.data))}function k(a){a.target.removeEventListener(LoaderEvent.COMPLETE,h,this);a.target.removeEventListener(LoaderEvent.ERROR,k,this);this.dispatchEvent(new LoaderEvent(LoaderEvent.ERROR))}function m(a){this.dispatchEvent(a)}return{init:function(){this._super();this._resourcesQueue=this._settingsLoader=null;this._slotEngineController;this._currentState;this._lostConnection=!1;this.VALID_MSG_VALUES=[SlotEngineMain.MSG_SUCCESS,SlotEngineMain.MSG_REALITY_CHECK,SlotEngineMain.MSG_TIME_PROXIMITY_ALERT,
SlotEngineMain.MSG_CREDIT_LEFT_ALERT];this.events=[SlotEngineMain.SPIN,SlotEngineMain.COLLECT,SlotEngineMain.GAMBLE,SlotEngineMain.JACKPOT,SlotEngineMain.SET_RESULT,SlotEngineMain.HIDE_GAME]},setData:function(a){if(!this._lostConnection){var b=GameSettings.getInstance();isNaN(a.totalBet)||(b.totalBet=a.totalBet);isNaN(a.totalWin)||(b.totalWin=a.totalWin);if("responsibleGaming"==a.command){if(this._slotEngineController)this._slotEngineController.onResponsibleGamingEvent(a.msg)}else if("responsibleGamingComplete"==
a.command){if(this._slotEngineController)this._slotEngineController.onResponsibleGamingCompleteEvent()}else if(a.msg==SlotEngineMain.MSG_INSUFFICIENT_FUNDS)b.balance=a.balance,b.serverMessage=new CollectMessage(a.state),this._slotEngineController.onServerResponse();else if("event"==a.command&&a.lostConnection||a.msg&&-1==this.VALID_MSG_VALUES.indexOf(a.msg))if(this._lostConnection=!0,b.balance=a.balance,this._slotEngineController)this._slotEngineController.onLostConnection();else this._settingsLoader&&
this._settingsLoader.stop(),this._resourcesQueue&&this._resourcesQueue.stop();else if("event"==a.command&&a.complex){if(b.jackpotValues=[a.complex.levelI,a.complex.levelII,a.complex.levelIII,a.complex.levelIV],this._slotEngineController)this._slotEngineController.onJackpotValuesUpdated(void 0!=a.complex.winLevel?a.complex.winLevel:-1,a.complex.screenName,a.complex.winAmount)}else if("show"==a.command){b.balance=a.balance;b.currencyType=a.currency;b.gameType=a.gameType;b.gameName=a.login.complex[a.gameType][0].gameName;
b.gameVersion=b.gameName+" v: "+Loader.cacheTimestamp.split("|")[0];b.engineType=a.engineType;b.rtp=a.settings.rtp;!1==a.login.showRtp&&(b.rtp=void 0);b.autoplayLimit=a.login.autoplayLimit;b.sendTotalsInfo=a.login.sendTotalsInfo;b.minimumSpinTime=a.login.minimumSpinTime;b.buildTimestamp=a.buildTimestamp;b.bonusSpinsModel.setBonusSpins(a.login.complex[a.gameType][0].bonusSpins);for(var d in PlatformSettings.currencies)if(PlatformSettings.currencies[d].name==a.currency){"yes"==PlatformSettings.currencies[d].displayCreditsOnly?
b.currency=!1:"yes"==PlatformSettings.currencies[d].displayBanknotesOnly?b.displayBanknotesOnly=!0:"yes"==PlatformSettings.currencies[d].noCoins?b.noCoins=!0:"yes"==PlatformSettings.currencies[d].noCredits&&(b.currencyDoNotDisplayCredits=!0);break}b.betValues=a.settings.bets.slice();b.denominations=a.settings.denominations.slice();b.jackpotAllowed=a.settings.jackpot;b.jackpotAllowed&&(b.jackpotMinBet=a.settings.jackpotMinBet,b.jackpotMaxBet=a.settings.jackpotMaxBet);b.paytableCoeficients=a.settings.paytableCoef;
b.translations=CommonSettings.translations;b.currLanguage=a.language;b.mainFakeReels=a.settings.mainFakeReels.slice();a.settings.freespinFakeReels&&(b.freespinFakeReels=a.settings.freespinFakeReels.slice());if(a.settings.lines){d=a.settings.lines.length-1;for(var c=4;0<=d;d--,c--)b.comboCoeficients[c]=a.settings.lines[d]}b.currDenominationIndex=0;b.currBetIndex=0;b.currLineIndex=4;b.jackpotAllowed&&(b.jackpotValues=[a.subscribe.jackpotState.levelI,a.subscribe.jackpotState.levelII,a.subscribe.jackpotState.levelIII,
a.subscribe.jackpotState.levelIV]);a.subscribe.currentState.gameNumber=a.gameNumber;this._currentState=new CurrentState(a.subscribe.currentState);a=GameSettings.getInstance();a.translations[a.currLanguage]||(a.currLanguage="en");console.log(a.currLanguage);a=GameSettings.getInstance();this._settingsLoader=new ScriptLoader(a.engineType+"/games/"+a.gameType+"/"+a.gameType+"Config.js");this._settingsLoader.addEventListener(LoaderEvent.COMPLETE,f,this);this._settingsLoader.addEventListener(LoaderEvent.ERROR,
g,this);this._settingsLoader.load()}else"bet"==a.command&&(a.complex.gameCommand==BaseMessage.COMMAND_SPIN?b.serverMessage=new SpinMessage(a.complex.reels,b.lineGame?a.complex.lines:a.complex.combos,a.complex.scatters,a.complex.expand,a.winAmount,a.complex.gambles,a.complex.jackpot,a.complex.freespins,a.complex.freespinsPerLine,a.complex.freespinScatters,a.gameNumber,a.state):a.complex.gameCommand==BaseMessage.COMMAND_GAMBLE?b.serverMessage=new GambleMessage(a.complex.card,a.winAmount,a.complex.gambles,
a.complex.jackpot,a.state):a.complex.gameCommand==BaseMessage.COMMAND_JACKPOT?b.serverMessage=new JackpotMessage(a.complex.card,a.winAmount,a.complex.winLevel,a.state):a.complex.gameCommand==BaseMessage.COMMAND_COLLECT&&(b.serverMessage=new CollectMessage(a.state)),null!=a.bonusSpins&&(b.bonusSpinsModel.setRemainingBonusSpins(a.bonusSpins.remainingBonusSpins),b.bonusSpinsModel.statusCode=a.bonusSpins.statusCode),b.balance=a.balance,this._slotEngineController.setBalance(),this._slotEngineController.onServerResponse())}},
event:function(a,b){if(this._slotEngineController&&"drag"==a)this._slotEngineController.onSlideEvent(b)}}}());
